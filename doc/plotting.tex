% PLOTTING.TEX
%
% The documentation in this file is part of PyXPlot
% <http://www.pyxplot.org.uk>
%
% Copyright (C) 2006-2010 Dominic Ford <coders@pyxplot.org.uk>
%               2009-2010 Ross Church
%
% $Id$
%
% PyXPlot is free software; you can redistribute it and/or modify it under the
% terms of the GNU General Public License as published by the Free Software
% Foundation; either version 2 of the License, or (at your option) any later
% version.
%
% You should have received a copy of the GNU General Public License along with
% PyXPlot; if not, write to the Free Software Foundation, Inc., 51 Franklin
% Street, Fifth Floor, Boston, MA  02110-1301, USA

% ----------------------------------------------------------------------------

% LaTeX source for the PyXPlot Users' Guide

\chapter{Advanced Plotting}
\label{ch:plotting}

In this chapter, we explore the various options of the {\tt plot} command.

\section{Formatting and Terminals}
\label{sec:set_terminal}

In this section, we describe the commands used to control the format of the
graphic output produced by PyXPlot. This continues the discussion from
Section~\ref{sec:directing_output} of how the \indcmdt{set terminal} can be
used to produce plots in various graphic formats, such as postscript files,
jpeg images, etc.

Many of these {\it terminals} -- the word we use to describe an output format
-- accept additional parameters which configure the exact appearance of the
output produced.  For example, the default terminal, {\tt X11}, which displays
plots on the screen, has such settings. By default, each time a new plot is
generated, if the previous plot is still open on the display, the old plot is
replaced with the new one. This way, only one plot window is open at any one
time.  This behaviour has the advantage that the desktop does not become
flooded with plot windows.

If this is not desired, however -- for example if you want to compare two plots
-- old graphs can be kept visible when plotting further graphs by using the the
{\tt X11\_MultiWindow} terminal:\index{X11 terminal}\index{multiple windows}

\begin{verbatim}
set terminal X11_SingleWindow
plot sin(x)
plot cos(x)  <-- first plot window disappears
\end{verbatim}

\noindent c.f.:

\begin{verbatim}
set terminal X11_MultiWindow
plot sin(x)
plot cos(x)  <-- first plot window remains
\end{verbatim}

As an additional option, the {\tt X11\_Persist} terminal keeps plot windows
open after PyXPlot exits; the above two terminals close all plot windows upon
exit.

If the {\tt enlarge} modifier is used with the \indcmdt{set terminal} then the
whole plot is enlarged, or, in the case of large plots, shrunk, to the current
paper size, minus a small margin. The aspect ratio of the plot is preserved.
This is most useful with the {\tt postscript} terminal, when preparing a plot
to send directly to a printer.

The {\tt set terminal} command takes many options. Its complete syntax is:

\begin{verbatim}
set terminal { X11_SingleWindow | X11_MultiWindow | X11_Persist |
               bmp | eps | gif | jpeg | pdf | png | postscript |
               svg | tiff }
             { colour | color | monochrome }
             { dpi <value> }
             { portrait | landscape }
             { invert | noinvert }
             { transparent | solid }
             { antialias | noantialias }
             { enlarge | noenlarge }
\end{verbatim}

The following table lists the effects which each of these settings has:

\begin{longtable}{p{3cm}p{9cm}}
{\tt X11\_SingleWindow} & Displays plots on the screen (in X11 windows, using \ghostview). Each time a new plot is generated, it replaces the old one, to prevent the desktop from becoming flooded with old plots.\footnote{The authors are aware of a bug, that this terminal can occasionally go blank when a new plot is generated. This is a known bug in \ghostview, and can be worked around by selecting File $\to$ Reload within the \ghostview\ window.} {\bf [default when running interactively; see below]}\\
{\tt X11\_MultiWindow} & As above, but each new plot appears in a new window, and the old plots remain visible. As many plots as may be desired can be left on the desktop simultaneously.\\
{\tt X11\_Persist} & As above, but plot windows remain open after PyXPlot closes.\\
{\tt bmp} & Sends output to a Windows bitmap ({\tt .bmp}) file. The filename for this file should be set using {\tt set output}. This is a bitmap graphics terminal. \index{bmp output}\\
{\tt eps} & As above, but produces encapsulated postscript.\index{encapsulated postscript}\index{postscript!encapsulated}\\
{\tt gif} & As above, but produces a gif image. This is a bitmap graphics terminal.\index{gif output}\\
{\tt jpeg} & As above, but produces a jpeg image. This is a bitmap graphics terminal.\index{jpeg output}\\
{\tt pdf} & As above, but produces pdf output.\index{pdf output}\\
{\tt png} & As above, but produces a png image. This is a bitmap graphics terminal.\index{png output}\\
{\tt postscript} & As above, but sends output to a postscript file. {\bf [default when running non-interactively; see below]}\index{postscript output}\\
{\tt svg} & As above, but produces an svg image.\footnote{The {\tt svg} output terminal is experimental and may be unstable. It relies upon the use of the {\tt svg} output device in Ghostscript, which may not be present on all systems.}\index{svg output}\\
{\tt tiff} & As above, but produces a tiff image. This is a bitmap graphics terminal.\index{tiff output}\\
{\tt colour} & Allows datasets to be plotted in colour. Automatically they will be displayed in a series of different colours, or alternatively colours may be specified using the {\tt with colour} plot modifier (see below). {\bf [default]}\index{colour output}\\
{\tt color} & Equivalent US spelling of the above. \\
{\tt monochrome} & Opposite to the above; all datasets will be plotted in black by default.\index{monochrome output}\\
{\tt portrait} & Sets plots to be displayed in upright (normal) orientation. {\bf [default]}\index{portrait orientation}\\
{\tt landscape} & Opposite of the above; produces side-ways plots. Not very useful when displayed on the screen, but you fit more on a sheet of paper that way around.\index{landscape orientation}\\
{\tt invert} & Modifier for the bitmap output terminals identified above -- i.e.\ the {\tt bmp}, {\tt gif}, {\tt jpeg}, {\tt png} and {\tt tiff} terminals -- which produces output with inverted colours.\footnote{This terminal setting is useful for producing plots to embed in talk slideshows, which often contain bright text on a dark background. It only works when producing bitmapped output, though a similar effect can be achieved in postscript using the {\tt set textcolour} and {\tt set axescolour} commands (see Section~\ref{sec:set_colours}).}\index{colours!inverting}\\
{\tt noinvert} & Modifier for the bitmap output terminals identified above; opposite to the above. {\bf [default]}\\
{\tt transparent} & Modifier for the {\tt gif} and {\tt png} terminals; produces output with a transparent background.\index{transparent terminal}\index{gif output!transparency}\index{png output!transparency}\\
{\tt solid} & Modifier for the {\tt gif} and {\tt png} terminals; opposite to the above. {\bf [default]}\\
{\tt antialias} & Modifier for the bitmap output terminals identified above; produces antialiased output, with colour boundaries smoothed to disguise the effects of pixelisation {\bf [default]}\\
{\tt noantialias} & Modifier for the bitmap output terminals identified above; opposite to the above\\
{\tt enlarge} & Enlarge or shrink contents to fit the current paper size.\index{enlarging output}\\
{\tt noenlarge} & Do not enlarge output; opposite to the above. {\bf [default]}\\
\end{longtable}

The default terminal is normally {\tt X11\_SingleWindow}, except when PyXPlot
is used non-interactively -- i.e.\ one or more command scripts are specified on
the command line, and PyXPlot exits as soon as it finishes executing them. In
this case, the {\tt X11\_SingleWindow} would not be a very sensible terminal to
use as any plot window would close as soon as PyXPlot exited. The default
terminal in this case changes to {\tt postscript}.

This rule does not apply when the special `--' filename is specified in a list
of command scripts on the command line, where an interactive terminal will
operate between running a series of scripts. In this case, PyXPlot detects that
the session will be interactive, and defaults to the usual {\tt
X11\_SingleWindow} terminal. Conversely, on machines where the {\tt DISPLAY}
environment variable\index{display environment variable@{\tt DISPLAY}
environment variable} is not set, PyXPlot detects that it has access to no
X-terminal on which to display plots, and defaults to the {\tt postscript}
terminal.

Use of the bitmap output terminals identified in the table above -- i.e.\ the
{\tt bmp}, {\tt gif}, {\tt jpeg}, {\tt png} and {\tt tiff} terminals --
inevitably results in some loss of image quality, since the plot has to be
rasterised into a bitmapped graphic image.  By default, this rasterisation is
performed at $300\,\mathrm{dpi}$, though this may be changed using the command
{\tt set terminal dpi <value>}. Alternatively, it may be changed using the {\tt
DPI} option in the {\tt settings} section of a configuration file (see
Chapter~\ref{ch:configuration}).\index{set terminal command!dpi modifier@{\tt
dpi} modifier}\index{bitmap output!resolution}\index{image resolution}

\section{Backing Up Over-Written Files}

\index{overwriting files}\index{backup files}\label{sec:file_backup}

By default, when graphical output is sent to a file -- i.e.\ a postscript file or
a bitmap image -- pre-existing files are overwritten if their filenames match
that of the file which PyXPlot generates. This behaviour may be changed with
the \indcmdt{set backup}, which has the syntax:

\begin{verbatim}
set backup
set nobackup
\end{verbatim}

When this switch is turned on, pre-existing files will be renamed with a tilde
appended to their filenames, rather than being overwritten.

\section{Paper Sizes}
\label{sec:set_papersize}

By default, when the postscript terminal produces printable, i.e.\ not
encapsulated, output, the paper size for this output is read from the user's
system locale settings. It may be changed, however, with \indcmdt{set
papersize}, which may be followed either by the name of a recognised paper
size, or by the dimensions of a user-defined size, specified as a {\tt height},
{\tt width} pair, both being measured in millimetres. For example:

\begin{verbatim}
set papersize a4
set papersize 100,100
\end{verbatim}

\noindent A complete list of recognised paper size names can be found in
Appendix~\ref{ch:paper_sizes}.\footnote{Marcus Kuhn has written a very complete
treatise on international paper sizes, which can be downloaded from:
\url{http://www.cl.cam.ac.uk/~mgk25/iso-paper.html}. Further details on the
Swedish extensions to this system, and the Japanese B-series, can be found on
Wikipedia: \url{http://en.wikipedia.org/wiki/Paper_size}.}\index{Kuhn,
Marcus}\index{paper sizes}

\section{A Tour of PyXPlot's Plot Styles}

We begin by reviewing the various plot styles which are available in PyXPlot.
Two of these we have already met: {\tt lines}, which draws straight lines
between \datapoint s, and {\tt points}, which does not connect \datapoint s.

\subsection{Lines and Points}

The following are PyXPlot's most basic plot styles\footnote{This is not an
exhaustive list; see Section~\ref{sec:list_of_plotstyles}.}:
\begin{itemize}
\item \indpst{dots} -- places a small dot at each datum.
\item \indpst{points} -- places a marker symbol at each datum.
\item \indpst{lines} -- connects adjacent \datapoint s with straight lines.
\item \indpst{linespoints} -- a combination of both lines and points.
\end{itemize}

When using the \indpst{points}, \indpst{linespoints} and \indpst{dots} plot
styles, the size of the plotted points or dots can be varied by using the
\indmodt{pointsize} modifier. For example,

\begin{verbatim}
set samples 25
plot sin(x) with dots pointsize 10
\end{verbatim}

\noindent would represent data with large dots. The default value of this
setting is $1.0$. The width of lines can similarly be controlled with the
\indmodt{linewidth} modifier, and the width of the lines used to draw point
symbols can be controlled with the \indmodt{pointlinewidth} modifier. For
example:

\begin{verbatim}
set samples 25
plot sin(x) with points pointlinewidth 2
\end{verbatim}

\noindent In addition to setting these parameters on a per-plot basis, their
default values can also be changed. The command:

\begin{verbatim}
set pointlinewidth 2
\end{verbatim}

\noindent would set the default line width used when drawing \datapoint s. Both
here, and in the {\tt plot} command, the abbreviation {\tt plw} is valid.

\subsection{Upper- and Lower-Limit Data Points}

The plot styles {\tt upperlimits} and {\tt lowerlimits} may be used to plot
\datapoint s using the standard upper- and lower-limit
symbols.\index{lower-limit datapoints}\index{upper-limit datapoints}:

\begin{verbatim}
plot 'upperlimits.dat' with upperlimits
plot 'lowerlimits.dat' with lowerlimits
\end{verbatim}

\subsection{Drawing Arrows}

Data may be represented as arrows connecting two points on a plot by using the
\indpst{arrows} plot style.  This takes four columns of data -- $x_1$, $y_1$,
$x_2$ and $y_2$ -- and for each \datapoint\ draws an arrow from the point
$(x_1,y_1)$ to the point $(x_2,y_2)$.  Three different kinds of arrows can be
drawn: ones with normal arrow heads, ones with no arrow heads, which just
appear as lines, and ones with arrow heads on both ends. The syntax to obtain
these varieties is:

\begin{verbatim}
plot 'data.dat' with arrows_head
plot 'data.dat' with arrows_nohead
plot 'data.dat' with arrows_twohead
\end{verbatim}

The syntax {\tt with arrows} is a shorthand for {\tt with arrows\_head}.

\subsection{Error Bars}
\index{errorbars}\label{sec:errorbars}

Points may be drawn with error bars either by specifying the size of the error
bar together with its centre point, in the fashion $5\pm2$, or by specifying a
minimum to maximum range for the error bar, in the fashion $5^{+2}_{-3}$. The
former is achieved using the syntax:

\begin{verbatim}
plot 'data.dat' with yerrorbars
\end{verbatim}

\noindent which takes three columns of data: these are the $x$- and
$y$-coordinates of the centre point about which the error bar is to be placed,
and the magnitude of the error bar along the $y$-axis. The latter is achieved
using the syntax:

\begin{verbatim}
plot 'data.dat' with yerrorrange
\end{verbatim}

\noindent which takes four columns of data: these are the $x$- and
$y$-coordinates of the centre point about which the error bar is to be placed,
the position of the bottom of the error bar along the $y$-axis, and the
position of the top of the error bar along the $y$-axis.

Similar plot styles exist with the letter {\tt y} replaced with the letter {\tt
x} to produce error bars along the $x$-axis. The plot styles {\tt xyerrorbars}
and {\tt xyerrorrange} simultaneously produce horizontal and vertical error
bars -- the former takes four columns of data and draws the sizes of the
horizontal and vertical error bars from the third and fourth data columns
respectively, meanwhile the latter takes six columns of data and draws the
horizontal minimum, horizontal maximum, vertical minimum and vertical maximum
from columns $4$--$6$ respectively.

The plot styles {\tt errorbars} and {\tt errorrange} are shorthands for {\tt
yerrorbars} and {\tt yerrorrange} respectively. For clarity, a complete list of
the errorbar plot styles available in the $xy$-plane in PyXPlot is given below:

\begin{longtable}{p{2.5cm}p{7.5cm}}
\indpst{yerrorbars} & Vertical errorbars; size drawn from the third data column. \\
\indpst{xerrorbars} & Horizontal errorbars; size drawn from the third data column. \\
\indpst{xyerrorbars} & Horizontal and vertical errorbars; sizes drawn from the third and fourth data columns respectively.\\
\indpst{errorbars} & Shorthand for {\tt yerrorbars}. \\
\indpst{yerrorrange} & Vertical errorbars; minimum drawn from the third data column, maximum from the fourth.\\
\indpst{xerrorrange} & Horizontal errorbars; minimum drawn from the third data column, maximum from the fourth.\\
\indpst{xyerrorrange} & Horizontal and vertical errorbars; horizontal minimum drawn from the third data column and maximum from the fourth; vertical minimum drawn from the fifth and maximum from the sixth.\\
\indpst{errorrange} & Shorthand for {\tt yerrorrange}. \\
\end{longtable}

Corresponding plot styles exist for producing error bars on any combination of
the $x$-, $y$- and $z$-axes of three-dimensional plots.

\subsection{Plotting Functions with Errorbars, Arrows, or More}

The use of plot styles such as {\tt errorbars} when plotting functions, as
opposed to \datafile s, often requires more than one function to be supplied.
For example, whilst the syntax

\begin{verbatim}
plot sin(x) with lines
\end{verbatim}

\noindent is sufficient for the {\tt lines} plot style, which only takes two
columns of data -- in this case, $x$ and $\sin(x)$ -- it is not sufficient for
the {\tt yerrorbars} plot style which takes three columns of data. In such
cases, the syntax

\begin{verbatim}
plot f(x):g(x) with yerrorbars
\end{verbatim}

\noindent is used. In this case, two functions are supplied, separated by a
colon; plotting proceeds as if a \datafile\ had been supplied, containing
values of $x$ in column~1, values of $f(x)$ in column~2, and values of $g(x)$
in column~3. In this example, $g(x)$ provides the uncertainty in the value of
$f(x)$.  The {\tt using} modifier may also be used in combination with such
syntax, as in

\begin{verbatim}
plot f(x):g(x) using 2:3
\end{verbatim}

\noindent though this example is not sensible. $g(x)$ would be plotted on the
$y$-axis, against $f(x)$ on the $x$-axis. However, this is unlikely to be
sensible because the range of values of $x$ substituting into these expressions
would correspond to the range of the plot's horizontal axis. The result might
be particularly unexpected if the above were attempted with an autoscaling
horizontal axis -- PyXPlot would find itself autoscaling the $x$-axis range to
the spread of values of $f(x)$, but find that this itself changed depending
upon the range of the $x$-axis. In this case, the user should have used the
{\tt parametric} plot option.

\subsection{Plotting parametric functions}

\section{Barcharts and Histograms}
\label{sec:barcharts}\index{bar charts}
\index{steps plot style@{\tt steps} plot style}
\index{fsteps plot style@{\tt fsteps} plot style}
\index{histeps plot style@{\tt histeps} plot style}
\index{impulses plot style@{\tt impulses} plot style}

\subsection{Basic Operation}

Bar charts and histograms can be produced using the \indpst{boxes} plot style:

\begin{verbatim}
plot 'data.dat' with boxes
\end{verbatim}

\noindent Horizontally, the interfaces between the bars are, by default, at the
midpoints along the $x$-axis between the specified \datapoint s (see, for
example, Figure~\ref{fig:ex_barchart2}a).  Alternatively, the widths of the
bars may be set using the {\tt set boxwidth} command. In this case, all of
the bars will be centred upon their specified $x$-co-ordinates, and have total
widths equalling that specified in the \indcmdt{set boxwidth}. Consequently, there may be
gaps between them, or they may overlap, as seen in
Figure~\ref{fig:ex_barchart2}(b).

\begin{figure}
\begin{center}
\includegraphics[width=\textwidth]{examples/eps/ex_barchart2.eps}
\end{center}
\caption[A gallery of the various bar chart styles which PyXPlot can produce]
{A gallery of the various bar chart styles which PyXPlot can produce.
See the text for more details.  The script and data file used to produce this
image are available on the PyXPlot website at
\protect\url{http://www.pyxplot.org.uk/examples/Manual/04barchart2/}.}
\label{fig:ex_barchart2}
\end{figure}

Having set a fixed box width, the default behaviour of scaling box widths
automatically may be restored either with the {\tt unset boxwidth} command,
or by setting the boxwidth to a negative width.

As a third alternative, it is also possible to specify different widths for
each bar manually, in an additional column of the input \datafile. To achieve
this behaviour, the \indpst{wboxes} plot style should be used:

\begin{verbatim}
plot 'data.dat' using 1:2:3 with wboxes
\end{verbatim}

\noindent This plot style expects three columns of data to be provided: the
$x$- and $y$-co-ordinates of each bar in the first two, and the width of the
bars in the third.  Figure~\ref{fig:ex_barchart2}(c) shows an example of this
plot style in use.

By default, the bars originate from the line $y=0$, as is normal for a
histogram. However, should it be desired for the bars to start from a different
vertical point, this may be achieved by using the \indcmdt{set boxfrom},
for example:

\begin{verbatim}
set boxfrom 5
\end{verbatim}

\noindent In this case, all of the bars would now originate from the line
$y=5$. Figure~\ref{fig:ex_barchart1}(1) shows the kind of effect that is
achieved; for comparison, Figure~\ref{fig:ex_barchart1}(b) shows the same bar
chart with the boxes starting from their default position of $y=0$.

\begin{figure}
\begin{center}
\includegraphics[width=\textwidth]{examples/eps/ex_barchart1.eps}
\end{center}
\caption[A second gallery of the various bar chart styles which PyXPlot can
produce]
{A second gallery of the various bar chart styles which PyXPlot can
produce. See the text for more details.  The script and data file used to
produce this image are available on the PyXPlot website at
\protect\url{http://www.pyxplot.org.uk/examples/Manual/03barchart1/}.}
\label{fig:ex_barchart1}
\end{figure}

The bars may be filled using the {\tt with} \indmodt{fillcolour} modifier,
followed by the name of a colour:

\begin{verbatim}
plot 'data.dat' with boxes fillcolour blue
plot 'data.dat' with boxes fc 4
\end{verbatim}

\noindent Figures~\ref{fig:ex_barchart2}(b) and (d) demonstrate the use of
filled bars.

Finally, the \indpst{impulses} plot style produces bars of zero width; see
Figure~\ref{fig:ex_barchart1}(c) for an example.

\subsection{Stacked Bar Charts}

If several \datapoint s are supplied to the \indpst{boxes} or \indpst{wboxes}
plot styles at a common $x$-co-ordinate, then the bars are stacked one above
another into a stacked barchart. Consider the following \datafile:

\begin{verbatim}
1 1
2 2
2 3
3 4
\end{verbatim}

\noindent The second bar at $x=2$ would be placed on top of the first, spanning
the range $2<y<5$, and having the same width as the first. If plot colours are
being automatically selected from the palette, then a different palette colour
is used to plot the upper bar.

\subsection{Steps}

The plot styles met so far plot data as solid bars, with left, right and top
sides all drawn. Data may also be plotted with {\it steps}, with the left and
right sides of each bar omitted. Some examples are shown in
Figures~\ref{fig:ex_barchart1}(d), (e) and (f).  As is illustrated in these
panels, three flavours of steps are available:

\begin{verbatim}
plot 'data.dat' with steps
plot 'data.dat' with fsteps
plot 'data.dat' with histeps
\end{verbatim}

\noindent When using the \indpst{steps} plot style, the \datapoint s specify the
right-most edges of each step. When using the \indpst{fsteps} plot style, they
specify the left-most edges of the steps. The \indpst{histeps} plot style works
rather like the {\tt boxes} plot style; the interfaces between the steps occur
at the horizontal midpoints between the \datapoint s.

\section{Configuring Axes}
\label{sec:multiple_axes}

By default, plots have only one $x$-axis and one $y$-axis. Further parallel
axes can be added and configured via statements such as:\index{axes
modifier@{\tt axes} modifier}\indcmd{set axis}

\begin{verbatim}
set x3label 'foo'
plot sin(x) axes x3y1
set axis x3
\end{verbatim}

\noindent In the top statement, a further horizontal axis, called the
$x3$-axis, is implicitly created by giving it a label. In the next, the {\tt
axes} modifier is used to tell the {\tt plot} command to plot data using the
horizontal $x3$-axis and the vertical $y$-axis. Here again, the axis would be
implicitly created if it didn't already exist.  In the third statement, an
$x3$-axis is explicitly created.  PyXPlot allows plots to have very large
numbers of axes: the only constraint is that axis numbers must lie in the range
1-512, though it is unlikely that there would ever be a practical purpose for
so many axes.  As a rule, all odd-numbered $x$-axes appear below the plot, and
even numbered $x$-axes above it; a similar rule applies for $y$-axes, to the
left and to the right.  This is illustrated in Example~\ref{ex:multiaxes}.

\example{ex:multiaxes}{The use of large numbers of axes}{
A plot demonstrating the use of large numbers of axes. Odd-numbered
$x$-axes appear below the plot, and even numbered $x$-axes above it; a similar
rule applies for $y$-axes, to the left and to the right.\\
\centerline{\includegraphics[width=\textwidth]{examples/eps/ex_multiaxes.eps}}
}

As discussed in the previous chapter, the ranges of axes can be set either
using the \indcmdt{set xrange}, or within the {\tt plot} command. The following
two statements would set equivalent ranges for the $x3$-axis:

\begin{verbatim}
set x3range [-2:2]
plot [:][:][:][:][-2:2] sin(x) axes x3y1
\end{verbatim}

\noindent As usual, the first two ranges specified in the {\tt plot} command
apply to the $x$- and $y$-axes. The next pair apply to the $x2$- and $y2$-axes,
and so forth.

\index{axes!removal}\index{removing axes}\index{hidden axes} Having made axes
with the above commands, they may subsequently be removed using the
\indcmdt{unset axis} as follows:

\begin{verbatim}
unset axis x3
unset axis x3x5y3 y7
\end{verbatim}

\noindent The top statement, for example, would remove axis $x3$. The command
{\tt unset axis} on its own, with no axes specified, returns all axes to
their default configuration.  The special case of {\tt unset axis x1} does
not remove the first $x$-axis -- it cannot be removed -- but instead returns it
to its default configuration.

It should be noted that if the following two commands are typed in succession,
the second may not entirely negate the first:

\begin{verbatim}
set x3label 'foo'
unset x3label 'foo'
\end{verbatim}

\noindent If an $x3$-axis did not previously exist, then the first will have
implicitly created one. This would need to be removed with the {\tt unset axis
x3} command if it was not desired.

A subtly different task is that of removing labels from axes, or setting axes
not to display. To achieve this, a number of special axis labels are used.
Labelling an axis \indkeyt{nolabels} has the effect that no title or numerical
labels are placed upon it. Labelling it \indkeyt{nolabelstics} is stronger
still; this removes all tick marks from it as well (similar in effect to the
{\tt set noxtics} command; see below).  Finally, labelling it
\indkeyt{invisible} makes an axis completely invisible.

Labels may be placed on such axes, by suffixing the magic keywords above with a
colon and the desired title. For example:

\begin{verbatim}
set xlabel 'nolabels:Time'
\end{verbatim}

\noindent would produce an $x$-axis with no numeric labels, but a label of
`Time'.

In the unlikely event of wanting to label a normal axis with one of these magic
words\index{axes!reserved labels}\index{magic axis labels}, this may be
achieved by prefixing the magic word with a space. There is one further magic
axis label, {\tt linkaxis}, which will be described in
Section~\ref{sec:linked_axes}.

The ticks of axes can be configured to point either inward, towards the plot,
as is the default, or outward towards the axis labels, or in both directions.
This is achieved using the {\tt set xticdir} command, for example:

\begin{verbatim}
set xticdir inward
set y2ticdir outward
set x2ticdir both
\end{verbatim}

The position of ticks along each axis can be configured with the \indcmdt{set
xtics}. The appearance of ticks along any axis can be turned off with the
\indcmdt{set noxtics}. The syntax for these is given below:

\begin{verbatim}
set xtics { axis | border | inward | outward | both }
          {  autofreq
           | <increment>
           | <minimum>, <increment> { , <maximum> }
           | (     {"label"} <position>
               { , {"label"} <position> } .... )
          }
set noxtics
show xtics
\end{verbatim}

The keywords \indkeyt{inward}, \indkeyt{outward} and \indkeyt{both} alter the
directions of the ticks, and have the same effect as in the \indcmdt{set
xticdir}. The keyword \indkeyt{axis} is an alias for \indkeyt{inward}, and
\indkeyt{border} an alias for \indkeyt{outward}; both are provided for
compatibility with \gnuplot. If the keyword \indkeyt{autofreq} is given, the
automatic placement of ticks along the axis is restored.

If {\tt <minimum>, <increment>, <maximum>} are specified, then ticks are
placed at evenly spaced intervals between the specified limits. In the case of
logarithmic axes, {\tt <increment>} is applied multiplicatively.

Alternatively, the final form allows ticks to be placed on an axis
individually, and each given its own textual label.

The following example sets the $x1$-axis to have tick marks at
$x=0.05$, $0.1$, $0.2$ and $0.4$.  The $x2$-axis has symbolically labelled tics at
$x=1/\pi, 2/\pi$, etc., pointing outwards from the plot.  The left-hand
$y$-axis has tick marks placed automatically whereas the $y2$-axis has no tics
at all.  The overall effect is shown in Example~\ref{ex:axistics}.

\begin{verbatim}
set log x1x2
set grid x2
set xtics 0.05, 2, 0.4
set x2tics border \
     ("$\frac{1}{\pi}$" 1/pi,      "$\frac{1}{2\pi}$" 1/(2*pi), \
      "$\frac{1}{3\pi}$" 1/(3*pi), "$\frac{1}{4\pi}$" 1/(4*pi), \
      "$\frac{1}{5\pi}$" 1/(5*pi), "$\frac{1}{6\pi}$" 1/(6*pi))
set ytics autofreq
set noy2tics
\end{verbatim}

\example{ex:axistics}{A plot demonsrating the use of custom axis ticks}{
A plot illustrating some of the crossing points of the function $\exp(x)\sin(1/x)$.  The commands used to set up ticking on the axes in this plot are as given in the text.\\
\centerline{\includegraphics[width=\textwidth]{examples/eps/ex_axistics.eps}}
}

Minor tick marks can be placed on axes with the \indcmdt{set mxtics}, which has
the same syntax as above.

\section{Keys and Legends}\index{keys}\index{legends}

By default, plots are displayed with legends in their top-right corners. The
textual description of each dataset is drawn by default from the command used
to plot it. Alternatively, the user may specify his own description for each
dataset by following the {\tt plot} command with the \indmodt{title} modifier,
as follows:

\begin{verbatim}
plot sin(x) title 'A sine wave'
plot cos(x) title ''
\end{verbatim}

In the lower case, a blank title is specified, in which case PyXPlot makes no
entry for the dataset in the legend. This is useful if it is desired to place
some but not all datasets into the legend of a plot.  Alternatively, the
production of the legend can be completely turned off for all datasets using
the command \indcmdts{set nokey}. The opposite effect can be achieved by the
\indcmdt{set key}.

The \indcmdt{set key} command can also be used to dictate where on the plot the
legend should be placed, using a syntax along the lines of:

\begin{verbatim}
set key top right
\end{verbatim}

The following recognised positioning keywords are self-explanatory:
\indkeyt{top}, \indkeyt{bottom}, \indkeyt{left}, \indkeyt{right},
\indkeyt{xcentre} and \indkeyt{ycentre}. The word \indkeyt{outside} places the
key outside the plot, on its right side. The words \indkeyt{below} and
\indkeyt{above} place legends below and above the plot respectively.

In addition, two positional offset co-ordinates may be specified after such
keywords -- the first value is assumed to be an $x$-offset, and the second a
$y$-offset, both in units of centimetres. For example:

\begin{verbatim}
set key bottom left 0.0 -2
\end{verbatim}

\noindent would display a key below the bottom left corner of the graph.

By default, entries in the key are placed in a single vertical list. They can
instead be arranged into a number of columns by means of the \indcmdt{set
keycolumns}. This should be followed by the integer number of desired columns,
for example:

\begin{verbatim}
set keycolumns 2
\end{verbatim}

\noindent An example of a plot with a two-column legend is given in
Example~\ref{ex:legends}.

\example{ex:legends}{A plot demonstrating the use of a two-column legend}{
This plot shows how rapidly three functions, often approximated as
$x$, deviate from that approximation.  Furthermore it is an example of a plot
with a two-column legend, positioned below the plot using {\tt set key below}.
The complete script used to produce the plot can be found on the PyXPlot
website at \protect\url{http://www.pyxplot.org.uk/examples/Manual/07legends/}.\\
\centerline{\includegraphics[width=\textwidth]{examples/eps/ex_legends.eps}}
}

\section{The {\tt style} Keyword}

At times, the string of style keywords placed after the {\tt with} modifier in
{\tt plot} commands can grow rather unwieldy in its length. For clarity,
frequently used plot styles can be stored as numbered plot {\it styles}.  The
syntax for setting a numbered plot style is:

\begin{verbatim}
set style 2 points pointtype 3
\end{verbatim}

\noindent where the {\tt 2} is the identification number of the style. In a
subsequent {\tt plot} statement, this style can be recalled as follows:

\begin{verbatim}
plot sin(x) with style 2
\end{verbatim}

\section{Colour Plotting}

\index{colours!setting for datasets} In the {\tt with} clause of the plot
command, the modifier {\tt colour}, which can be abbreviated to
`{\tt c}', can be used to manually select the colour in which each dataset
is to be plotted. It should be followed either by an integer, to set a colour
from the present palette, or by a colour name. A list of valid colour names is
given in Section~\ref{sec:colour_names}. For example:

\begin{verbatim}
plot sin(x) with c 5
plot sin(x) with colour blue
\end{verbatim}

\noindent The {\tt colour} modifier can also be used when defining linestyles.

\index{palette}\index{colours!setting the palette} PyXPlot has a palette of
colours which it assigns sequentially to datasets when colours are not manually
assigned. This is also the palette to which integers passed to {\tt set colour}
refer -- the {\tt 5} above, for example. The sequence of colours which make up
the palette may be set using the \indcmdt{set palette}, which takes a
comma-separated list of colours, for example:

\begin{verbatim}
set palette BrickRed, LimeGreen, CadetBlue
\end{verbatim}

\noindent Another way of setting the palette, in a configuration file, is
described in Chapter~\ref{ch:configuration}; a list of valid colour names is
given in Section~\ref{sec:colour_names}.

\section{Plotting Many Files at Once}

\index{globbing}\index{wildcards}\index{datafiles!globbing}

PyXPlot allows the wildcards {\tt *} and {\tt ?} to be used in the filenames of
\datafile s supplied to the \indcmdt{plot}.  For example, the following would
plot all \datafile s in the current directory with a {\tt .dat} suffix, using
the same plot options:

\begin{verbatim}
plot '*.dat' with linewidth 2
\end{verbatim}

\noindent In the legend, full filenames are displayed, allowing the \datafile s
to be distinguished. If the user supplies a blank filename, the last used
\datafile\ is used again, for example:

\begin{verbatim}
plot 'data.dat' using 1:2, '' using 2:3
\end{verbatim}

\noindent or even:

\begin{verbatim}
plot '*.dat' using 1:2, '' using 2:3
\end{verbatim}

The {\tt *} and {\tt ?} wildcards can be used in a similar fashion in the
\indcmdt{load}.

\subsection{Arrows}

\label{sec:set_arrow}\index{arrows} Arrows may be placed on plots using the
\indcmdt{set arrow}. A simple example would be:

\begin{verbatim}
set arrow 1 from 0,0 to 1,1
\end{verbatim}

\noindent The number {\tt 1} immediately following \indcmdts{set arrow}
specifies an identification number for the arrow, allowing it to be
subsequently removed via the command:

\begin{verbatim}
unset arrow 1
\end{verbatim}

\noindent or equivalently, via:\indcmd{set noarrow}

\begin{verbatim}
set noarrow 1
\end{verbatim}

The {\tt set arrow} command can be followed by the keyword {\tt with} to
specify the style of the arrow. For example, the keywords \indkeyt{nohead},
\indkeyt{head} and \indkeyt{twohead}, placed after the keyword {\tt with}, can
be used to generate arrows with no arrow heads, normal arrow heads, or two
arrow heads.  \indkeyt{twoway} is an alias for \indkeyt{twohead}.  For example:

\begin{verbatim}
set arrow 1 from 0,0 to 1,1 with nohead
\end{verbatim}

\noindent Line types and colours can also be specified after the keyword {\tt
with}:

\begin{verbatim}
set arrow 1 from 0,0 to 1,1 with nohead \
linetype 1 c blue
\end{verbatim}

The co-ordinates for the start and end points of the arrow can be specified in
a range of co-ordinate systems. The co-ordinate system to be used should be
specified immediately before the co-ordinate value. The default system,
\indcot{first} measures the graph using the $x$- and $y$-axes. The
\indcot{second} system uses the $x2$- and $y2$-axes. The \indcot{screen} and
\indcot{graph} systems both measure in centimetres from the origin of the
graph. In the following example, we use these specifiers, and specify
co-ordinates using variables rather than doing so explicitly:

\begin{verbatim}
x0 = 0.0
y0 = 0.0
x1 = 1.0
y1 = 1.0
set arrow 1 from first  x0, first  y0 \
            to   screen x1, screen y1 \
            with nohead
\end{verbatim}

In addition to these four options, \indcot{axis{\it n}} specifies that the
position is to be measured along the $n\,$th $x$- or $y$-axis -- for example,
`{\tt axis3}'.\indcmd{set arrow} This allows the graph to be measured with
reference to any arbitrary axis on plots which make use of large numbers of
parallel axes (see Section~\ref{sec:multiple_axes}).

\subsection{Text Labels}

Text labels may be placed on plots using the \indcmdt{set label}. As with all
textual labels in PyXPlot, these are rendered in \LaTeX:

\begin{verbatim}
set label 1 'Hello World' at 0,0
\end{verbatim}

As in the previous section, the number {\tt 1} is a reference number, which
allows the label to be removed by either of the following two commands:

\begin{verbatim}
set nolabel 1
unset label 1
\end{verbatim}

\noindent The positional co-ordinates for the text label, placed after the {\tt
at} keyword, can be specified in any of the co-ordinate systems described for
arrows above. A rotation angle may optionally be specified after the keyword
\indkeyt{rotate}, to rotate text counter-clockwise by a given angle, measured
in degrees. For example, the following would produce upward-running text:

\begin{verbatim}
set label 1 'Hello World' at axis3 3.0, axis4 2.7 rotate 90
\end{verbatim}

A colour can also be specified, if desired, using the {\tt with colour}
modifier.  For example, the following would produce a green label at the origin:

\begin{verbatim}
set label 2 'This label is green' at 0, 0 with colour green
\end{verbatim}

\index{fontsize}\index{text!size} The fontsize of these text labels can be set
globally using the \indcmdt{set fontsize}. This applies not only to the {\tt
set label} command, but also to plot titles, axis labels, keys, etc. The value
given should be an integer in the range $-4 \leq x \leq 5$. The default is
zero, which corresponds to \LaTeX's {\tt normalsize}; $-4$ corresponds to {\tt
tiny} and 5 to {\tt Huge}.

\index{text!colour}\index{colours!text} The \indcmdt{set textcolour} can be
used to globally set the colour of all text output, and applies to all of the
text that the {\tt set fontsize} command does. It is especially useful when
producing plots to be embedded in presentation slideshows, where bright text on
a dark background may be desired. It should be followed either by an integer,
to set a colour from the present palette, or by a colour name. A list of the
recognised colour names can be found in Section~\ref{sec:colour_names}.  For
example:

\begin{verbatim}
set textcolour 2
set textcolour blue
\end{verbatim}

\index{text!alignment}\index{alignment!text}By default, each label's specified
position corresponds to its bottom left corner. This alignment may be changed
with the \indcmdts{set texthalign} and \indcmdts{set textvalign} commands. The
former takes the options \indkeyt{left}, \indkeyt{centre} or \indkeyt{right},
and the latter takes the options \indkeyt{bottom}, \indkeyt{centre} or
\indkeyt{top}, for example:

\begin{verbatim}
set texthalign right
set textvalign top
\end{verbatim}

An example of a somewhat unconventional plot containing many labels and lines
can be found in Figure~\ref{fig:ex_map}.

\begin{figure}
\begin{center}
\includegraphics[width=\textwidth]{examples/eps/ex_map.eps}
\end{center}
\caption[A map of Australia, plotted using PyXPlot]
{A map of Australia, plotted using PyXPlot.  The data were obtained
from \protect\url{http://www.maproom.psu.edu/dcw/} (for the coastal outlines
and state boundaries) and \protect\url{http://en.wikipedia.org} (for the city
locations).  The data files and script used to produce this map can be
downloaded from the PyXPlot website at
\protect\url{http://www.pyxplot.org.uk/examples/Manual/08map/}.}
\label{fig:ex_map}
\end{figure}

\section{Gridlines}

Gridlines may be placed on a plot and subsequently removed via the statements:

\begin{verbatim}
set grid
set nogrid
\end{verbatim}

\noindent respectively. The following commands are also valid:

\begin{verbatim}
unset grid
unset nogrid
\end{verbatim}

\noindent By default, gridlines are drawn from the major and minor ticks of the
default $x$- and $y$-axes (which are the first $x$- and $y$-axes unless set
otherwise in the configuration file; see Chapter~\ref{ch:configuration}).
However, the axes which should be used may be specified after the \indcmdt{set
grid}\index{grid}:

\begin{verbatim}
set grid x2y2
set grid x x2y2
\end{verbatim}

\noindent The top example would connect the gridlines to the ticks of the $x2$-
and $y2$-axes, whilst the lower would draw gridlines from both the $x$- and the
$x2$-axes.

If one of the specified axes does not exist, then no gridlines will be drawn in
that direction.  Gridlines can subsequently be removed selectively from some
axes via:

\begin{verbatim}
unset grid x2x3
\end{verbatim}

The colours of gridlines\index{grid!colour}\index{colours!grid} can be
controlled via the \indcmdts{set gridmajcolour} and \indcmdts{set
gridmincolour} commands, which control the gridlines emanating from major and
minor axis ticks respectively. An example would be:

\begin{verbatim}
set gridmincolour blue
\end{verbatim}

\noindent Any of the colour names listed in Section~\ref{sec:colour_names} can
be used.

A related command\index{axes!colour}\index{colours!axes} is \indcmdts{set
axescolour}, which has a syntax similar to that above, and sets the colour of
the graph's axes.\label{sec:set_colours}

