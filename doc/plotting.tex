% PLOTTING.TEX
%
% The documentation in this file is part of PyXPlot
% <http://www.pyxplot.org.uk>
%
% Copyright (C) 2006-2010 Dominic Ford <coders@pyxplot.org.uk>
%               2009-2010 Ross Church
%
% $Id$
%
% PyXPlot is free software; you can redistribute it and/or modify it under the
% terms of the GNU General Public License as published by the Free Software
% Foundation; either version 2 of the License, or (at your option) any later
% version.
%
% You should have received a copy of the GNU General Public License along with
% PyXPlot; if not, write to the Free Software Foundation, Inc., 51 Franklin
% Street, Fifth Floor, Boston, MA  02110-1301, USA

% ----------------------------------------------------------------------------

% LaTeX source for the PyXPlot Users' Guide

\chapter{Plotting: A Detailed Survey}
\label{ch:plotting}

Having described PyXPlot's mathematical environment and data-processing
facilities in detail, this part of the manual now returns to the subject of how
PyXPlot may be used to produce graphs and other vector graphics. In this
chapter we return to the \indcmdt{plot} to provide a more systematic survey of
how the appearance of plots can be configured, continuing from the brief
overview already given in Chapter~\ref{ch:first_steps}.  In the subsequent
chapters of this part, we will go on to describe how to produce graphical
output in a range of image formats (Chapter~\ref{ch:image_formats}) and how to
produce galleries of multiple plots side-by-side together with more
sophisticated vector graphics (Chapter~\ref{ch:vector_graphics}).

\section{The {\tt with} modifier}

Chapter~\ref{ch:first_steps} provided an overview of the syntax of the
\indcmdt{plot}, including the {\tt every}, {\tt index}, {\tt select} and {\tt
using} modifiers which can be used to control {\tt which} data, read from a
\datafile or sampled from a function, should be plotted. The {\tt with}
modifier controls {\tt how} data should be plotted. For example, the statement
\begin{verbatim}
plot "data.dat" index 1 using 4:5 with lines
\end{verbatim}
specifies that data should be plotted using lines connecting each \datapoint to
its neighbours. More generally, the {\tt with} modifier can be followed by a
range of settings which fine-tune the manner in which the data are displayed;
for example, the statement
\begin{verbatim}
plot "data.dat" with lines linewidth 2.0
\end{verbatim}
would use twice the default width of line.

In the following section, a complete list of all of PyXPlot's plot styles --
i.e.\ all of the words which may be used in place of {\tt lines} -- will be
given. In this section, we list all of the modifiers such as {\tt line\-width}
which may be used to alter the exact appearance of these plot styles, which are
as follows:
\begin{itemize}
\item \indmodt{colour} -- used to select the colour in which each dataset is to be plotted. It should be followed either by an integer, to set a colour from the present palette (see Section~\ref{sec:palette}), or by a recognised colour name, a complete list of which can be found in Section~\ref{sec:colour_names}, or as an RGB colour in the form {\tt rgb1:2:3}, where the integers should be in the range~0 to~255. May also be spelt {\tt color}.\index{colours!setting for datasets}
\item \indmodt{fillcolour} -- used to select the colour in which each dataset is filled. This is not applicable to any of the plot styles listed above, but is included here for completeness. The colour may be specified using any of the styles listed for {\tt colour}. May also be spelt {\tt fillcolour}.
\item \indmodt{linetype} -- used to select the type of line -- for example, solid, dotted, dashed, etc.\ -- which should be used in line-based plot styles. A complete list of PyXPlot's numbered line types can be found in Chapter~\ref{ch:linetypes_table}. May be abbreviated {\tt lt}.
\item \indmodt{linewidth} -- used to select the width of line, where~1 represent the default width, which should be used in line-based plot styles. May be abbreviated {\tt lw}.
\item \indmodt{pointlinewidth} -- used to select the width of line, where~1 represent the default width, which should be used to stroke points in point-based plot styles. May be abbreviated {\tt plw}.
\item \indmodt{pointsize} -- used to select the size of drawn points, where~1 represent the default size. May be abbreviated {\tt ps}.
\item \indmodt{pointtype} -- used to select the type of point -- for example, crosses, circles, etc.\ -- used by point-based plot styles. A complete list of PyXPlot's numbered point types can be found in Chapter~\ref{ch:linetypes_table}. May be abbreviated {\tt pt}.
\end{itemize}

Any number of these modifiers may be placed sequentially after the {\tt with}
keyword, as in the following examples:

\begin{verbatim}
plot 'datafile' using 1:2 with points pointsize 2
plot 'datafile' using 1:2 with lines colour red linewidth 2
plot 'datafile' using 1:2 with lp col 1 lw 2 ps 3
\end{verbatim}

\noindent Not all of these modifiers are applicable to all of PyXPlot's plot
styles. For example, the {\tt line\-width} modifier has no effect on plot
styles which do not draw lines between datapoints. Where modifiers are applied
to plot styles for which they have no defined effect, the modifier has no
effect, but no error results.  Table~\ref{tab:style_modifiers} lists which
modifiers act upon which plot styles.

\begin{table}
\centerline{\includegraphics[width=\textwidth]{examples/eps/ex_plotstyletab.eps}}
\caption{A list of the plot styles affected by each style modifiers.}
\label{tab:style_modifiers}
\end{table}

\subsection{The Palette}
\label{sec:palette}

\index{palette}\index{colours!setting the palette} As indicated above, colours
may be referred to either specifically by name or RGB components, or by their
numbers in the current palette. By default, PyXPlot's palette contains a series
of visually distinctive colours which are insofar as possible are also
distinctive to users with most common forms of colour blindness. The current
palette may be queried using the \indcmdt{show palette}, and changed using the
\indcmdt{set palette}, which takes a comma-separated list of colours, as in the
example:

\begin{verbatim}
set palette BrickRed, LimeGreen, CadetBlue
\end{verbatim}

\noindent The palette is treated as a cyclic list, and so in the above example,
colour number~4 would map to {\tt BrickRed}, as would colour number~0. A list
of all of the named colours which PyXPlot recognises is given in
Section~\ref{sec:colour_names}. The default palette which PyXPlot uses upon
startup may be changed by setting up a configuration file, as described in
Chapter~\ref{ch:configuration}.

\subsection{Default Settings}

In addition to setting these parameters on a per-dataset basis, the {\tt
linewidth}, {\tt pointlinewidth} and {\tt pointsize} settings can also have
their default values changed for all datasets as in the following examples:
\begin{verbatim}
set linewidth 1
set pointlinewidth 2
set pointsize 3
plot "datafile"
\end{verbatim}
In each case, the normal default values of these settings are~1. The default
values of the {\tt colour}, {\tt linetype} and {\tt pointtype} settings depend
upon whether the current graphic output device is set to produce colour or
monochrome output (see Chapter~\ref{sec:set_terminal}). In the former case
(colour output), the colours of each of the comma-separated datasets plotted on
a graph are drawn sequentially from the currently-selected palette, all lines
are drawn as solid lines ({\tt line\-type~1}), and the symbols used to draw
each dataset are drawn sequentially from PyXPlot's available point types. In
the latter case (monochrome output), all datasets are plotted in black, and
both the line types and point types used to draw each dataset are drawn
sequentially from PyXPlot's available options. The following simple example
demonstrates this:
\begin{verbatim}
set terminal colour
plot [][6:0] 1 with lp, 2 with lp, 3 w lp, 4 w lp, 5 w lp
set terminal monochrome
replot
\end{verbatim}
\centerline{\includegraphics[width=\textwidth]{examples/eps/ex_col_vs_mono.eps}}

\section{PyXPlot's Plot Styles}

This section provides an exhaustive list of all of PyXPlot's {\it plot styles},
which we place into a series of groups for clarity.

\subsection{Lines and Points}

The following is a list of PyXPlot's simplest plot styles, all of which take as
input two columns of data, representing the $x$- and $y$-coordinates of the
positions of each point:
\begin{itemize}
\item \indpst{dots} -- places a small dot at each datum.
\item \indpst{lines} -- connects adjacent \datapoint s with straight lines.
\item \indpst{linespoints} -- a combination of both lines and points.
\item \indpst{lowerlimits} -- places a lower-limit sign (\includegraphics{examples/eps/ex_lowerlimit.eps}) at each datum.\index{lower-limit datapoints}
\item \indpst{points} -- places a marker symbol at each datum.
\item \indpst{stars} -- similar to {\tt points}, but uses a different set of marker symbols, based upon the stars drawn in Johann Bayer's highly ornate star atlas {\tt Uranometria} of 1603.
\item \indpst{upperlimits} -- places an upper-limit sign (\includegraphics{examples/eps/ex_upperlimit.eps}) at each datum.\index{upper-limit datapoints}
\end{itemize}

\subsection{Error Bars}
\index{errorbars}\label{sec:errorbars}

The following pair of plot styles allow datapoints to be plotted with errorbars
indicating the uncertainties in either their vertical or horizontal positions:
\begin{itemize}
\item \indpst{yerrorbars}
\item \indpst{xerrorbars}
\end{itemize}
Both of these plot styles take three columns of input data, the first two of
which represent the $x$- and $y$-coordinates of the positions of each point,
and the last of which represents the uncertainty in either the $x$- and
$y$-coordinate.  The plot style \indpst{errorbars} is an alias for
\indpst{yerrorbars}.  Additionally, the following plot style allows datapoints
to be plotted with both horizontal and vertical errorbars:
\begin{itemize}
\item \indpst{xyerrorbars}
\end{itemize}
This plot style takes four columns of data as input, the first two of which
represent the $x$- and $y$-coordinates of the positions of each point, the
third of which gives the uncertainty in the $x$-coordinate, and the last of
which gives the uncertainty in the $y$-coordinate.

Each of the plot styles listed above has a corresponding partner which takes
minimum and maximum limit in place of each uncertainty, equivalent to writing
$5^{+2}_{-3}$ instead of $5\pm2$, except that the limits of~2 and~7 should be
given in place of $5-3$ and $5+2$:
\begin{itemize}
\item \indpst{xerrorrange} -- takes four columns of data.
\item \indpst{yerrorrange} -- takes four columns of data.
\item \indpst{xyerrorrange} -- takes six columns of data.
\end{itemize}
The plot style \indpst{errorrange} is an alias of \indpst{yerrorrange}.

Corresponding plot styles also exist to plot data with errorbars along the
$z$-axes of three-dimensional plots\footnote{These plot styles are currently
present for future expansion purposes only, as PyXPlot~0.8.0 cannot produce
three-dimensional plots.}: {\tt zerrorbars}, {\tt zerrorrange}, {\tt
xzerrorbars}, {\tt xzerrorrange}, {\tt yzerrorbars}, {\tt yzerrorrange}, {\tt
xyzerrorbars}, {\tt xyzerrorrange}.

\subsection{Shaded Regions}

The following plot styles allow regions of graphs to be shaded with colour:
\begin{itemize}
\item \indpst{yerrorshaded}
\item \indpst{shadedregion}
\end{itemize}

Both of these plot styles fill specified regions of graphs with the selected
{\tt fillcolour} and draw a line around the boundary of the region with the
selected {\tt colour}, {\tt linetype} and {\tt linewidth}. They differ in the
format in which they expect the input data to be arranged. The
\indpst{yerrorshaded} plot style expects data to be arranged in the same format
as the \indpst{yerrorrange} plot style, specifying the $x$- and $y$-coordinates
of a series of \datapoint s in the first two columns, together with the minimum
and maximum extremes of the vertical errorbar on each \datapoint in the third
and fourth columns. The region contained between the upper and lower limits of
the error bars is filled with colour; the $y$-coordinate specified in the
second column is unused. This plot style provides easy conversion between plots
drawn with errorbars and with shaded error regions. Note that the \datapoint s
must be sorted in order of either increasing or decreasing $x$-coordinate for
sensible behaviour.

The \indpst{shadedregion} plot style takes only two columns of input data,
specifying the $x$- and $y$-coordinates of a series of \datapoint s which are
to be joined in a join-the-dots fashion. At the end of each dataset, the drawn
path is closed and filled.

\subsection{Barcharts and Histograms}
\label{sec:barcharts}
\index{bar charts}

Bar charts and histograms can be produced using the \indpst{boxes} plot style:

\begin{verbatim}
plot 'data.dat' with boxes
\end{verbatim}

\noindent Horizontally, the interfaces between the bars are, by default, at the
midpoints along the $x$-axis between the specified \datapoint s (see, for
example, Figure~\ref{fig:ex_barchart2}a).  Alternatively, the widths of the
bars may be set using the {\tt set boxwidth} command. In this case, all of
the bars will be centred upon their specified $x$-co-ordinates, and have total
widths equalling that specified in the \indcmdt{set boxwidth}. Consequently, there may be
gaps between them, or they may overlap, as seen in
Figure~\ref{fig:ex_barchart2}(b).

\begin{figure}
\begin{center}
\includegraphics[width=\textwidth]{examples/eps/ex_barchart2.eps}
\end{center}
\caption[A gallery of the various bar chart styles which PyXPlot can produce]
{A gallery of the various bar chart styles which PyXPlot can produce.
See the text for more details.  The script and data file used to produce this
image are available on the PyXPlot website at
\protect\url{http://www.pyxplot.org.uk/examples/Manual/04barchart2/}.}
\label{fig:ex_barchart2}
\end{figure}

Having set a fixed box width, the default behaviour of scaling box widths
automatically may be restored either with the {\tt unset boxwidth} command,
or by setting the boxwidth to a negative width.

As a third alternative, it is also possible to specify different widths for
each bar manually, in an additional column of the input \datafile. To achieve
this behaviour, the \indpst{wboxes} plot style should be used:

\begin{verbatim}
plot 'data.dat' using 1:2:3 with wboxes
\end{verbatim}

\noindent This plot style expects three columns of data to be provided: the
$x$- and $y$-co-ordinates of each bar in the first two, and the width of the
bars in the third.  Figure~\ref{fig:ex_barchart2}(c) shows an example of this
plot style in use.

By default, the bars originate from the line $y=0$, as is normal for a
histogram. However, should it be desired for the bars to start from a different
vertical point, this may be achieved by using the \indcmdt{set boxfrom},
for example:

\begin{verbatim}
set boxfrom 5
\end{verbatim}

\noindent In this case, all of the bars would now originate from the line
$y=5$. Figure~\ref{fig:ex_barchart1}(1) shows the kind of effect that is
achieved; for comparison, Figure~\ref{fig:ex_barchart1}(b) shows the same bar
chart with the boxes starting from their default position of $y=0$.

\begin{figure}
\begin{center}
\includegraphics[width=\textwidth]{examples/eps/ex_barchart1.eps}
\end{center}
\caption[A second gallery of the various bar chart styles which PyXPlot can
produce]
{A second gallery of the various bar chart styles which PyXPlot can
produce. See the text for more details.  The script and data file used to
produce this image are available on the PyXPlot website at
\protect\url{http://www.pyxplot.org.uk/examples/Manual/03barchart1/}.}
\label{fig:ex_barchart1}
\end{figure}

The bars may be filled using the {\tt with} \indmodt{fillcolour} modifier,
followed by the name of a colour:

\begin{verbatim}
plot 'data.dat' with boxes fillcolour blue
plot 'data.dat' with boxes fc 4
\end{verbatim}

\noindent Figures~\ref{fig:ex_barchart2}(b) and (d) demonstrate the use of
filled bars.

Finally, the \indpst{impulses} plot style produces bars of zero width; see
Figure~\ref{fig:ex_barchart1}(c) for an example.

\subsubsection{Stacked Bar Charts}

If several \datapoint s are supplied to the \indpst{boxes} or \indpst{wboxes}
plot styles at a common $x$-co-ordinate, then the bars are stacked one above
another into a stacked barchart. Consider the following \datafile:

\begin{verbatim}
1 1
2 2
2 3
3 4
\end{verbatim}

\noindent The second bar at $x=2$ would be placed on top of the first, spanning
the range $2<y<5$, and having the same width as the first. If plot colours are
being automatically selected from the palette, then a different palette colour
is used to plot the upper bar.

\subsection{Steps}

The following plot styles allow data to be plotted with a series of horizontal
steps associated with each supplied \datapoint:
\begin{itemize}
\item \indpst{steps}
\item \indpst{fsteps}
\item \indpst{histeps}
\end{itemize}
Like the {\tt points} plot style, each of these styles take only two columns of
data as input, containing the $x$- and $y$-coordinates of each \datapoint.  An
example of their appearance  is shown in Figures~\ref{fig:ex_barchart1}(d), (e)
and (f); for clarity, the positions of each of the supplied \datapoint s are
marked by red crosses.  These plot styles differ in their placement of the
edges of each of the horizontal steps.  The \indpst{steps} plot style places
the right-most edge of each step on the \datapoint\ it represents.  The
\indpst{fsteps} plot style places the left-most edge of each step on the
\datapoint\ it represents.  The \indpst{histeps} plot style centres each step
upon the \datapoint\ it represents.

\subsection{Arrows}

The following plot styles allow arrows or lines to be drawn on graphs with
positions dictated by a series of \datapoint s:
\begin{itemize}
\item \indpst{arrows\_head}
\item \indpst{arrows\_nohead}
\item \indpst{arrows\_twohead}
\end{itemize}
The plot style of \indpst{arrows} is an alias for \indpst{arrows\_head}.  Each
of these plot styles take four columns of data -- $x_1$, $y_1$, $x_2$ and $y_2$
-- and each \datapoint\ results in an arrow being drawn from the point
$(x_1,y_1)$ to the point $(x_2,y_2)$. The three plot styles differ in the kinds
of arrows that they draw. \indpst{arrows\_head} draws an arrow head at the
point $(x_2,y_2)$; \indpst{arrows\_nohead} draws a simple line without arrow
heads on either end; \indpst{arrows\_twohead} draws arrow heads on both ends of
the arrow.

\example{ex:vortex}{A diagram of fluid flow around a vortex}{
In this example we produce a velocity map of fluid circulating in a vortex. For
simplicity, we assume that the fluid in the core of the vortex, at radii $r<1$,
is undergoing solid body rotation with velocity $v\propto r$, and that the
fluid outside this core is behaving as a free vortex with velocity $v\propto
1/r$. First of all, we use a simple python script to generate a \datafile with
the four columns:
\nlscf
\noindent{\tt from math import *}\newline
\noindent{\tt for i in range(-19,20,2):}\newline
\noindent{\tt \phantom{x}for j in range(-19,20,2):}\newline
\noindent{\tt \phantom{xx}x = float(i)/2}\newline
\noindent{\tt \phantom{xx}y = float(j)/2}\newline
\noindent{\tt \phantom{xx}r = sqrt(x**2 + y**2) / 4}\newline
\noindent{\tt \phantom{xx}theta = atan2(y,x)}\newline
\noindent{\tt \phantom{xx}if (r $<$ 1.0): v = 1.3*r}\newline
\noindent{\tt \phantom{xx}else        : v = 1.3/r}\newline
\noindent{\tt \phantom{xx}vy = v *  cos(theta)}\newline
\noindent{\tt \phantom{xx}vx = v * -sin(theta)}\newline
\noindent{\tt \phantom{xx}print "\%7.3f \%7.3f \%7.3f \%7.3f"\%(x,y,vx,vy)}
\nlscf
This data can then be plotted using the following PyXPlot script:
\nlscf
\noindent{\tt set size square}\newline
\noindent{\tt set nokey}\newline
\noindent{\tt set xlabel 'x'}\newline
\noindent{\tt set ylabel 'y'}\newline
\noindent{\tt set trange [0:2*pi]}\newline
\noindent{\tt plot $\backslash$}\newline
\noindent{\tt \phantom{x}'data' u 1:2:(\$1+\$3):(\$2+\$4) w arrows, $\backslash$}\newline
\noindent{\tt \phantom{x}parametric 4*sin(t):4*cos(t) w lt 2 col black}
\nlscf
\centerline{\includegraphics[width=10cm]{examples/eps/ex_vortex.eps}}
}

\section{The {\tt style} Keyword}

At times, the string of style keywords placed after the {\tt with} modifier in
{\tt plot} commands can grow rather unwieldy in its length. For clarity,
frequently used plot styles can be stored as numbered plot {\it styles}.  The
syntax for setting a numbered plot style is:

\begin{verbatim}
set style 2 points pointtype 3
\end{verbatim}

\noindent where the {\tt 2} is the identification number of the style. In a
subsequent {\tt plot} statement, this style can be recalled as follows:

\begin{verbatim}
plot sin(x) with style 2
\end{verbatim}

\section{Plotting Functions in Exotic Styles}

The use of plot styles such as {\tt errorbars} when plotting functions, as
opposed to \datafile s, often requires more than one function to be supplied.
For example, whilst the syntax

\begin{verbatim}
plot sin(x) with lines
\end{verbatim}

\noindent is sufficient for the {\tt lines} plot style, which only takes two
columns of data -- in this case, $x$ and $\sin(x)$ -- it is not sufficient for
the {\tt yerrorbars} plot style which takes three columns of data. In such
cases, the syntax

\begin{verbatim}
plot f(x):g(x) with yerrorbars
\end{verbatim}

\noindent is used. In this case, two functions are supplied, separated by a
colon; plotting proceeds as if a \datafile\ had been supplied, containing
values of $x$ in column~1, values of $f(x)$ in column~2, and values of $g(x)$
in column~3. In this example, $g(x)$ provides the uncertainty in the value of
$f(x)$.  The {\tt using} modifier may also be used in combination with such
syntax, as in

\begin{verbatim}
plot f(x):g(x) using 2:3
\end{verbatim}

\noindent though this example is not sensible. $g(x)$ would be plotted on the
$y$-axis, against $f(x)$ on the $x$-axis. However, this is unlikely to be
sensible because the range of values of $x$ substituting into these expressions
would correspond to the range of the plot's horizontal axis. The result might
be particularly unexpected if the above were attempted with an autoscaling
horizontal axis -- PyXPlot would find itself autoscaling the $x$-axis range to
the spread of values of $f(x)$, but find that this itself changed depending
upon the range of the $x$-axis. In this case, the user should have used the
{\tt parametric} plot option described in the next section.

\section{Plotting Parametric Functions}
\label{sec:parametric_plotting}

Parametric functions may be plotted by placing the keyword {\tt parametric}
before the list of functions to be plotted, as in the example:
\begin{verbatim}
plot parametric sin(t):cos(t)
\end{verbatim}

\section{Graph Legends}
\index{keys}\index{legends}
\label{sec:legends}

By default, plots are displayed with legends in their top-right corners. The
textual description of each dataset is drawn by default from the command used
to plot it. Alternatively, the user may specify his own description for each
dataset by following the {\tt plot} command with the \indmodt{title} modifier,
as follows:

\begin{verbatim}
plot sin(x) title 'A sine wave'
plot cos(x) title ''
\end{verbatim}

In the lower case, a blank title is specified, in which case PyXPlot makes no
entry for the dataset in the legend. This is useful if it is desired to place
some but not all datasets into the legend of a plot.  Alternatively, the
production of the legend can be completely turned off for all datasets using
the command \indcmdts{set nokey}. The opposite effect can be achieved by the
\indcmdt{set key}.

The \indcmdt{set key} command can also be used to dictate where on the plot the
legend should be placed, using a syntax along the lines of:

\begin{verbatim}
set key top right
\end{verbatim}

The following recognised positioning keywords are self-explanatory:
\indkeyt{top}, \indkeyt{bottom}, \indkeyt{left}, \indkeyt{right},
\indkeyt{xcentre} and \indkeyt{ycentre}. The word \indkeyt{outside} places the
key outside the plot, on its right side. The words \indkeyt{below} and
\indkeyt{above} place legends below and above the plot respectively.

In addition, two positional offset co-ordinates may be specified after such
keywords -- the first value is assumed to be an $x$-offset, and the second a
$y$-offset, both in units of centimetres. For example:

\begin{verbatim}
set key bottom left 0.0 -2
\end{verbatim}

\noindent would display a key below the bottom left corner of the graph.

By default, entries in the key are placed in a single vertical list. They can
instead be arranged into a number of columns by means of the \indcmdt{set
keycolumns}. This should be followed by the integer number of desired columns,
for example:

\begin{verbatim}
set keycolumns 2
\end{verbatim}

\noindent An example of a plot with a two-column legend is given in
Example~\ref{ex:legends}.

\example{ex:legends}{A plot demonstrating the use of a two-column legend}{
This plot shows how rapidly three functions, often approximated as
$x$, deviate from that approximation.  Furthermore it is an example of a plot
with a two-column legend, positioned below the plot using {\tt set key below}.
The complete script used to produce the plot can be found on the PyXPlot
website at \protect\url{http://www.pyxplot.org.uk/examples/Manual/07legends/}.
\nlscf
\centerline{\includegraphics[width=\textwidth]{examples/eps/ex_legends.eps}}
}

\section{Configuring Axes}
\label{sec:multiple_axes}

By default, plots have only one $x$-axis and one $y$-axis. Further parallel
axes can be added and configured via statements such as:\index{axes
modifier@{\tt axes} modifier}\indcmd{set axis}

\begin{verbatim}
set x3label 'foo'
plot sin(x) axes x3y1
set axis x3
\end{verbatim}

\noindent In the top statement, a further horizontal axis, called the
$x3$-axis, is implicitly created by giving it a label. In the next, the {\tt
axes} modifier is used to tell the {\tt plot} command to plot data using the
horizontal $x3$-axis and the vertical $y$-axis. Here again, the axis would be
implicitly created if it didn't already exist.  In the third statement, an
$x3$-axis is explicitly created.  PyXPlot allows plots to have very large
numbers of axes: the only constraint is that axis numbers must lie in the range
1-512, though it is unlikely that there would ever be a practical purpose for
so many axes.  As a rule, all odd-numbered $x$-axes appear below the plot, and
even numbered $x$-axes above it; a similar rule applies for $y$-axes, to the
left and to the right.  This is illustrated in Example~\ref{ex:multiaxes}.

\example{ex:multiaxes}{The use of large numbers of axes}{
A plot demonstrating the use of large numbers of axes. Odd-numbered
$x$-axes appear below the plot, and even numbered $x$-axes above it; a similar
rule applies for $y$-axes, to the left and to the right.
\nlscf
\centerline{\includegraphics[width=\textwidth]{examples/eps/ex_multiaxes.eps}}
}

As discussed in the previous chapter, the ranges of axes can be set either
using the \indcmdt{set xrange}, or within the {\tt plot} command. The following
two statements would set equivalent ranges for the $x3$-axis:

\begin{verbatim}
set x3range [-2:2]
plot [:][:][:][:][-2:2] sin(x) axes x3y1
\end{verbatim}

\noindent As usual, the first two ranges specified in the {\tt plot} command
apply to the $x$- and $y$-axes. The next pair apply to the $x2$- and $y2$-axes,
and so forth.

\index{axes!removal}\index{removing axes}\index{hidden axes} Having made axes
with the above commands, they may subsequently be removed using the
\indcmdt{unset axis} as follows:

\begin{verbatim}
unset axis x3
unset axis x3x5y3 y7
\end{verbatim}

\noindent The top statement, for example, would remove axis $x3$. The command
{\tt unset axis} on its own, with no axes specified, returns all axes to
their default configuration.  The special case of {\tt unset axis x1} does
not remove the first $x$-axis -- it cannot be removed -- but instead returns it
to its default configuration.

It should be noted that if the following two commands are typed in succession,
the second may not entirely negate the first:

\begin{verbatim}
set x3label 'foo'
unset x3label 'foo'
\end{verbatim}

\noindent If an $x3$-axis did not previously exist, then the first will have
implicitly created one. This would need to be removed with the {\tt unset axis
x3} command if it was not desired.

A subtly different task is that of removing labels from axes, or setting axes
not to display. To achieve this, a number of special axis labels are used.
Labelling an axis \indkeyt{nolabels} has the effect that no title or numerical
labels are placed upon it. Labelling it \indkeyt{nolabelstics} is stronger
still; this removes all tick marks from it as well (similar in effect to the
{\tt set noxtics} command; see below).  Finally, labelling it
\indkeyt{invisible} makes an axis completely invisible.

Labels may be placed on such axes, by suffixing the magic keywords above with a
colon and the desired title. For example:

\begin{verbatim}
set xlabel 'nolabels:Time'
\end{verbatim}

\noindent would produce an $x$-axis with no numeric labels, but a label of
`Time'.

In the unlikely event of wanting to label a normal axis with one of these magic
words\index{axes!reserved labels}\index{magic axis labels}, this may be
achieved by prefixing the magic word with a space. There is one further magic
axis label, {\tt linkaxis}, which will be described in
Section~\ref{sec:linked_axes}.

The ticks of axes can be configured to point either inward, towards the plot,
as is the default, or outward towards the axis labels, or in both directions.
This is achieved using the {\tt set xticdir} command, for example:

\begin{verbatim}
set xticdir inward
set y2ticdir outward
set x2ticdir both
\end{verbatim}

The position of ticks along each axis can be configured with the \indcmdt{set
xtics}. The appearance of ticks along any axis can be turned off with the
\indcmdt{set noxtics}. The syntax for these is given below:

\begin{verbatim}
set xtics { axis | border | inward | outward | both }
          {  autofreq
           | <increment>
           | <minimum>, <increment> { , <maximum> }
           | (     {"label"} <position>
               { , {"label"} <position> } .... )
          }
set noxtics
show xtics
\end{verbatim}

The keywords \indkeyt{inward}, \indkeyt{outward} and \indkeyt{both} alter the
directions of the ticks, and have the same effect as in the \indcmdt{set
xticdir}. The keyword \indkeyt{axis} is an alias for \indkeyt{inward}, and
\indkeyt{border} an alias for \indkeyt{outward}; both are provided for
compatibility with \gnuplot. If the keyword \indkeyt{autofreq} is given, the
automatic placement of ticks along the axis is restored.

If {\tt <minimum>, <increment>, <maximum>} are specified, then ticks are
placed at evenly spaced intervals between the specified limits. In the case of
logarithmic axes, {\tt <increment>} is applied multiplicatively.

Alternatively, the final form allows ticks to be placed on an axis
individually, and each given its own textual label.

The following example sets the $x1$-axis to have tick marks at
$x=0.05$, $0.1$, $0.2$ and $0.4$.  The $x2$-axis has symbolically labelled tics at
$x=1/\pi, 2/\pi$, etc., pointing outwards from the plot.  The left-hand
$y$-axis has tick marks placed automatically whereas the $y2$-axis has no tics
at all.  The overall effect is shown in Example~\ref{ex:axistics}.

\begin{verbatim}
set log x1x2
set grid x2
set xtics 0.05, 2, 0.4
set x2tics border \
     ("$\frac{1}{\pi}$" 1/pi,      "$\frac{1}{2\pi}$" 1/(2*pi), \
      "$\frac{1}{3\pi}$" 1/(3*pi), "$\frac{1}{4\pi}$" 1/(4*pi), \
      "$\frac{1}{5\pi}$" 1/(5*pi), "$\frac{1}{6\pi}$" 1/(6*pi))
set ytics autofreq
set noy2tics
\end{verbatim}

\example{ex:axistics}{A plot demonsrating the use of custom axis ticks}{
A plot illustrating some of the crossing points of the function
$\exp(x)\sin(1/x)$.  The commands used to set up ticking on the axes in this
plot are as given in the text.
\nlscf
\centerline{\includegraphics[width=\textwidth]{examples/eps/ex_axistics.eps}}
}

Minor tick marks can be placed on axes with the \indcmdt{set mxtics}, which has
the same syntax as above.

\subsection{Configuring how Tick Marks are Labelled}

\section{Gridlines}

Gridlines may be placed on a plot and subsequently removed via the statements:

\begin{verbatim}
set grid
set nogrid
\end{verbatim}

\noindent respectively. The following commands are also valid:

\begin{verbatim}
unset grid
unset nogrid
\end{verbatim}

\noindent By default, gridlines are drawn from the major and minor ticks of the
default $x$- and $y$-axes (which are the first $x$- and $y$-axes unless set
otherwise in the configuration file; see Chapter~\ref{ch:configuration}).
However, the axes which should be used may be specified after the \indcmdt{set
grid}\index{grid}:

\begin{verbatim}
set grid x2y2
set grid x x2y2
\end{verbatim}

\noindent The top example would connect the gridlines to the ticks of the $x2$-
and $y2$-axes, whilst the lower would draw gridlines from both the $x$- and the
$x2$-axes.

If one of the specified axes does not exist, then no gridlines will be drawn in
that direction.  Gridlines can subsequently be removed selectively from some
axes via:

\begin{verbatim}
unset grid x2x3
\end{verbatim}

The colours of gridlines\index{grid!colour}\index{colours!grid} can be
controlled via the \indcmdts{set gridmajcolour} and \indcmdts{set
gridmincolour} commands, which control the gridlines emanating from major and
minor axis ticks respectively. An example would be:

\begin{verbatim}
set gridmincolour blue
\end{verbatim}

\noindent Any of the colour names listed in Section~\ref{sec:colour_names} can
be used.

A related command\index{axes!colour}\index{colours!axes} is \indcmdts{set
axescolour}, which has a syntax similar to that above, and sets the colour of
the graph's axes.\label{sec:set_colours}

\section{Linked Axes}

\section{Adding Labels}

\subsection{Arrows}

\label{sec:set_arrow}\index{arrows} Arrows may be placed on plots using the
\indcmdt{set arrow}. A simple example would be:

\begin{verbatim}
set arrow 1 from 0,0 to 1,1
\end{verbatim}

\noindent The number {\tt 1} immediately following \indcmdts{set arrow}
specifies an identification number for the arrow, allowing it to be
subsequently removed via the command:

\begin{verbatim}
unset arrow 1
\end{verbatim}

\noindent or equivalently, via:\indcmd{set noarrow}

\begin{verbatim}
set noarrow 1
\end{verbatim}

The {\tt set arrow} command can be followed by the keyword {\tt with} to
specify the style of the arrow. For example, the keywords \indkeyt{nohead},
\indkeyt{head} and \indkeyt{twohead}, placed after the keyword {\tt with}, can
be used to generate arrows with no arrow heads, normal arrow heads, or two
arrow heads.  \indkeyt{twoway} is an alias for \indkeyt{twohead}.  For example:

\begin{verbatim}
set arrow 1 from 0,0 to 1,1 with nohead
\end{verbatim}

\noindent Line types and colours can also be specified after the keyword {\tt
with}:

\begin{verbatim}
set arrow 1 from 0,0 to 1,1 with nohead \
linetype 1 c blue
\end{verbatim}

The co-ordinates for the start and end points of the arrow can be specified in
a range of co-ordinate systems. The co-ordinate system to be used should be
specified immediately before the co-ordinate value. The default system,
\indcot{first} measures the graph using the $x$- and $y$-axes. The
\indcot{second} system uses the $x2$- and $y2$-axes. The \indcot{screen} and
\indcot{graph} systems both measure in centimetres from the origin of the
graph. In the following example, we use these specifiers, and specify
co-ordinates using variables rather than doing so explicitly:

\begin{verbatim}
x0 = 0.0
y0 = 0.0
x1 = 1.0
y1 = 1.0
set arrow 1 from first  x0, first  y0 \
            to   screen x1, screen y1 \
            with nohead
\end{verbatim}

In addition to these four options, \indcot{axis{\it n}} specifies that the
position is to be measured along the $n\,$th $x$- or $y$-axis -- for example,
`{\tt axis3}'.\indcmd{set arrow} This allows the graph to be measured with
reference to any arbitrary axis on plots which make use of large numbers of
parallel axes (see Section~\ref{sec:multiple_axes}).

\subsection{Text Labels}

Text labels may be placed on plots using the \indcmdt{set label}. As with all
textual labels in PyXPlot, these are rendered in \LaTeX:

\begin{verbatim}
set label 1 'Hello World' at 0,0
\end{verbatim}

As in the previous section, the number {\tt 1} is a reference number, which
allows the label to be removed by either of the following two commands:

\begin{verbatim}
set nolabel 1
unset label 1
\end{verbatim}

\noindent The positional co-ordinates for the text label, placed after the {\tt
at} keyword, can be specified in any of the co-ordinate systems described for
arrows above. A rotation angle may optionally be specified after the keyword
\indkeyt{rotate}, to rotate text counter-clockwise by a given angle, measured
in degrees. For example, the following would produce upward-running text:

\begin{verbatim}
set label 1 'Hello World' at axis3 3.0, axis4 2.7 rotate 90
\end{verbatim}

A colour can also be specified, if desired, using the {\tt with colour}
modifier.  For example, the following would produce a green label at the origin:

\begin{verbatim}
set label 2 'This label is green' at 0, 0 with colour green
\end{verbatim}

\index{fontsize}\index{text!size} The fontsize of these text labels can be set
globally using the \indcmdt{set fontsize}. This applies not only to the {\tt
set label} command, but also to plot titles, axis labels, keys, etc. The value
given should be an integer in the range $-4 \leq x \leq 5$. The default is
zero, which corresponds to \LaTeX's {\tt normalsize}; $-4$ corresponds to {\tt
tiny} and 5 to {\tt Huge}.

\index{text!colour}\index{colours!text} The \indcmdt{set textcolour} can be
used to globally set the colour of all text output, and applies to all of the
text that the {\tt set fontsize} command does. It is especially useful when
producing plots to be embedded in presentation slideshows, where bright text on
a dark background may be desired. It should be followed either by an integer,
to set a colour from the present palette, or by a colour name. A list of the
recognised colour names can be found in Section~\ref{sec:colour_names}.  For
example:

\begin{verbatim}
set textcolour 2
set textcolour blue
\end{verbatim}

\index{text!alignment}\index{alignment!text}By default, each label's specified
position corresponds to its bottom left corner. This alignment may be changed
with the \indcmdts{set texthalign} and \indcmdts{set textvalign} commands. The
former takes the options \indkeyt{left}, \indkeyt{centre} or \indkeyt{right},
and the latter takes the options \indkeyt{bottom}, \indkeyt{centre} or
\indkeyt{top}, for example:

\begin{verbatim}
set texthalign right
set textvalign top
\end{verbatim}

\example{ex:hlines}{A diagram of the atomic lines of hydrogen}{
The wavelengths of the spectral lines of atomic hydrogen are given by the Rydberg formula,
\begin{displaymath}
\frac{1}{\lambda} = R_\mathrm{H}\left(\frac{1}{n^2}-\frac{1}{m^2}\right),
\end{displaymath}
where $\lambda$ is wavelength, $R_\mathrm{H}$ is the Rydberg constant,
predefined in PyXPlot as the variable {\tt phy\_Ry}, and {\tt n} and {\tt m}
are positive non-zero integers such that {\tt m>n}. The first few series are
called the Lyman series ({\tt n}$=1$), the Balmer series ({\tt n}$=2$), the
Paschen series ({\tt n}$=3$) and the Brackett series ({\tt n}$=4$). Within each
series, the lines are given Greek letter designations -- $\alpha$ for {\tt
m}$=${\tt n}$+1$, $\beta$ for {\tt m}$=${\tt n}$+2$, and so forth.
\nlnp
In the following example, we produce a diagram of the lines in the first four
series, drawing the first~20 lines within each. At the bottom of the diagram,
we overlay indications of the wavelengths of ten colour filters commonly used
by astronomers (data taken from Binney \& Merrifield, {\it Galactic Astronomy},
Princeton, 1998).
\nlscf
{\footnotesize
\noindent{\tt set numeric display latex}\newline
\noindent{\tt set width 20}\newline
\noindent{\tt set size ratio 0.4}\newline
\noindent{\tt set numerics sf 4}\newline
\noindent{\tt set log x}\newline
\noindent{\tt set x1label "Wavelength"}\newline
\noindent{\tt set x2label "Frequency"     ; set unit of frequency Hz}\newline
\noindent{\tt set x3label "Photon Energy" ; set unit of energy eV}\newline
\noindent{\tt set axis x2 linked x1 using phy\_c/x}\newline
\noindent{\tt set axis x3 linked x2 using phy\_h*x}\newline
\noindent{\tt set noytics ; set nomytics}\newline
}\\{\footnotesize
\noindent{\tt \# Draw lines of first four series of hydrogen lines}\newline
\noindent{\tt an=2}\newline
\noindent{\tt n=1}\newline
\noindent{\tt foreach SeriesName in ("Ly","Ba","Pa","Br")}\newline
\noindent{\tt \phantom{x}\{}\newline
\noindent{\tt \phantom{xx}for m=n+1 to n+21}\newline
\noindent{\tt \phantom{xxx}\{}\newline
\noindent{\tt \phantom{xxxx}wl = 1/(phy\_Ry*(1/n**2-1/m**2))}\newline
\noindent{\tt \phantom{xxxx}set arrow an from wl,0.3 to wl,0.6 with nohead col n}\newline
\noindent{\tt \phantom{xxxx}if (m-n==1) \{ ; GreekLetter = "$\backslash$$\backslash$alpha" ; \}}\newline
\noindent{\tt \phantom{xxxx}if (m-n==2) \{ ; GreekLetter = "$\backslash$$\backslash$beta"  ; \}}\newline
\noindent{\tt \phantom{xxxx}if (m-n==3) \{ ; GreekLetter = "$\backslash$$\backslash$gamma" ; \}}\newline
\noindent{\tt \phantom{xxxx}if (m-n$<$4)}\newline
\noindent{\tt \phantom{xxxxx}\{}\newline
\noindent{\tt \phantom{xxxxxx}set label an "$\backslash$parbox\{5cm\}\{$\backslash$footnotesize$\backslash$center\{$\backslash$}\newline
\noindent{\tt \phantom{xxxxxxxx}\%s-\$\%s\$$\backslash$$\backslash$newline \$\%d$\backslash$to\%d\$$\backslash$$\backslash$newline \%s$\backslash$$\backslash$newline\}\}" $\backslash$}\newline
\noindent{\tt \phantom{xxxxxxxx}\%(SeriesName,GreekLetter,n,m,wl) at wl,0.55+0.2*(m-n) $\backslash$}\newline
\noindent{\tt \phantom{xxxxxxxx}hal centre val centre}\newline
\noindent{\tt \phantom{xxxxx}\}}\newline
\noindent{\tt \phantom{xxxx}an = an+1}\newline
\noindent{\tt \phantom{xxx}\}}\newline
\noindent{\tt \phantom{xx}n=n+1}\newline
\noindent{\tt \phantom{x}\}}\newline
}\\{\footnotesize
\noindent{\tt \# Label astronomical photometric colours}\newline
\noindent{\tt foreach datum i,name,wl\_c,wl\_w in "--" using $\backslash$}\newline
\noindent{\tt \phantom{xxxx}1:"\%s"\%(\$2):(\$3*unit(nm)):(\$4*unit(nm))}\newline
\noindent{\tt \phantom{x}\{}\newline
\noindent{\tt \phantom{xx}arry = 0.12+0.1*(i\%2) \# Vertical positions for arrows}\newline
\noindent{\tt \phantom{xx}laby = 0.07+0.1*(i\%2) \# Vertical positions for labels}\newline
\noindent{\tt \phantom{xx}x0 = (wl\_c-wl\_w/2) \# Shortward end of passband}\newline
\noindent{\tt \phantom{xx}x1 =  wl\_c         \# Centre of passband}\newline
\noindent{\tt \phantom{xx}x2 = (wl\_c+wl\_w/2) \# Longward end of passband}\newline
\noindent{\tt \phantom{xx}set arrow an from x0,arry to x2,arry with nohead}\newline
\noindent{\tt \phantom{xx}set label an name at x1,laby hal centre val centre}\newline
\noindent{\tt \phantom{xx}an = an+1}\newline
\noindent{\tt \phantom{x}\}}\newline
\noindent{\tt \phantom{x}1 U  365   66}\newline
\noindent{\tt \phantom{x}2 B  445   94}\newline
\noindent{\tt \phantom{x}3 V  551   88}\newline
\noindent{\tt \phantom{x}4 R  658  138}\newline
\noindent{\tt \phantom{x}5 I  806  149}\newline
\noindent{\tt \phantom{x}6 J 1220  213}\newline
\noindent{\tt \phantom{x}7 H 1630  307}\newline
\noindent{\tt \phantom{x}8 K 2190  390}\newline
\noindent{\tt \phantom{x}9 L 3450  472}\newline
\noindent{\tt 10 M 4750  460}\newline
\noindent{\tt END}\newline
}\\{\footnotesize
\noindent{\tt \# Draw a marker for the Lyman limit}\newline
\noindent{\tt ll = 91.1267*unit(nm)}\newline
\noindent{\tt set arrow 1 from ll,0.12 to ll,0.22}\newline
\noindent{\tt set label 1 "Lyman Limit: \%s"\%(ll) at 95*unit(nm),0.17 $\backslash$}\newline
\noindent{\tt \phantom{xxxxx}hal left val centre}\newline
}\\{\footnotesize
\noindent{\tt \# Finally produce plot}\newline
\noindent{\tt plot [80*unit(nm):5500*unit(nm)][0:1.25]}\newline
}
\nlscf
\begin{center}
\includegraphics[width=11cm]{examples/eps/ex_hlines.eps}
\end{center}
}

\example{ex:australia}{A map of Australia}{
A map of Australia, plotted using PyXPlot.  The data were obtained
from \protect\url{http://www.maproom.psu.edu/dcw/} (for the coastal outlines
and state boundaries) and \protect\url{http://en.wikipedia.org} (for the city
locations). The data files and script used to produce this map can be
downloaded from the PyXPlot website at
\protect\url{http://www.pyxplot.org.uk/examples/Manual/08map/}.
\nlscf
\begin{center}
\includegraphics[width=\textwidth]{examples/eps/ex_map.eps}
\end{center}
}

% \section{Non-Flat Projections}

% \section{Three-Dimensional Plotting}

